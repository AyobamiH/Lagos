import{d as v,u as w,r as s}from"./index-CQqwMk0w.js";import{p,a as m}from"./validation-Bd_H_RqW.js";function O(){const o=v(),{token:l}=w(),[g,u]=s.useState(!1),[q,n]=s.useState(!1),[L,e]=s.useState(null),[R,a]=s.useState(null),S=s.useCallback(async({pickupLat:k,pickupLng:y,dropLat:Q,dropLng:b,productType:h,paymentMethod:i})=>{if(!l)return e("not_authenticated"),"error";u(!0),e(null),a(null),n(!1);try{const r=p(k),c=m(y),d=p(Q),f=m(b);if([r,c,d,f].some(E=>E===null))return e("invalid_coordinates"),u(!1),"error";const x={pickup:{lat:r,lng:c},dropoff:{lat:d,lng:f},productType:h,...i?{paymentMethod:i}:{}},t=await o.requestRideOrQueue(x);return t.mode==="queued"?(n(!0),"queued"):t.ride?(a(t.ride),"immediate"):(t.error&&e(t.error.error||t.error.message||"request_failed"),"error")}catch(r){return e((r==null?void 0:r.error)||"request_failed"),"error"}finally{u(!1)}},[o,l]);function _(){e(null),a(null),n(!1)}return{loading:g,queued:q,error:L,ride:R,submit:S,reset:_}}export{O as u};
