import{o as f,p as u,q as j,i as y,r as d,d as m,h as b,j as e,s as v}from"./index-CQqwMk0w.js";const S=()=>{const{flags:l}=f(),{data:o}=u(),{active:c,secondsLeft:g}=j(),{allOrdered:h}=y(),[p,x]=d.useState("unknown"),n=m();d.useEffect(()=>{var s;"serviceWorker"in navigator&&(navigator.serviceWorker.addEventListener("message",r=>{var t;((t=r.data)==null?void 0:t.type)==="SW_VERSION"&&x(r.data)}),(s=navigator.serviceWorker.controller)==null||s.postMessage({type:"CHECK_VERSION"}))},[]);const i=b(),a=Date.now();return e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsx("h2",{children:"Ops Panel"}),e.jsxs("section",{style:{background:"#fafafa",padding:8,borderRadius:4},children:[e.jsx("h3",{children:"Feature Flags"}),e.jsx("pre",{style:{maxHeight:180,overflow:"auto"},children:JSON.stringify(l,null,2)})]}),e.jsxs("section",{style:{background:"#fafafa",padding:8,borderRadius:4},children:[e.jsx("h3",{children:"Diagnostics"}),e.jsx("pre",{style:{maxHeight:180,overflow:"auto"},children:JSON.stringify(o,null,2)})]}),e.jsxs("section",{style:{background:"#fafafa",padding:8,borderRadius:4},children:[e.jsx("h3",{children:"Realtime"}),e.jsxs("p",{children:["Events buffered: ",h.length]})]}),e.jsxs("section",{style:{background:"#fafafa",padding:8,borderRadius:4},children:[e.jsx("h3",{children:"Rate Limit"}),e.jsx("p",{children:c?`Active (${g}s left)`:"Inactive"})]}),e.jsxs("section",{style:{background:"#fafafa",padding:8,borderRadius:4},children:[e.jsx("h3",{children:"Unified Action Queue"}),e.jsxs("p",{children:["Pending: ",n.pending," ",n.processing&&" (processing...)"]}),!!n.items.length&&e.jsx("ul",{style:{margin:0,paddingLeft:16,display:"grid",gap:4},children:n.items.map(s=>{const r=s.nextEligibleAt&&s.nextEligibleAt>a?s.nextEligibleAt-a:0;return e.jsxs("li",{style:{fontSize:12,background:"#fff",padding:4,borderRadius:4},children:[e.jsx("strong",{children:s.kind})," attempts:",s.attempts,r>0&&e.jsxs("span",{children:[" next in ",Math.ceil(r/1e3),"s"]}),s.lastError&&e.jsxs("span",{style:{color:"#c00"},children:[" err:",s.lastError]})]},s.id)})}),e.jsx("div",{style:{display:"flex",gap:8,marginTop:6,flexWrap:"wrap"},children:e.jsx("button",{onClick:()=>n.forceDrain(),disabled:n.processing||!n.pending,children:"Force Drain"})})]}),e.jsxs("section",{style:{background:"#fafafa",padding:8,borderRadius:4},children:[e.jsx("h3",{children:"Last Response Meta"}),e.jsxs("p",{style:{fontSize:12,margin:"4px 0"},children:["Correlation ID: ",e.jsx("code",{children:v||"n/a"})]}),i.etag&&e.jsxs("p",{style:{fontSize:12,margin:"4px 0"},children:["ETag: ",e.jsx("code",{children:i.etag})]}),e.jsxs("details",{children:[e.jsx("summary",{style:{cursor:"pointer",fontSize:12},children:"Headers"}),e.jsx("pre",{style:{maxHeight:140,overflow:"auto"},children:JSON.stringify(i,null,2)})]})]}),e.jsxs("section",{style:{background:"#fafafa",padding:8,borderRadius:4},children:[e.jsx("h3",{children:"Service Worker"}),e.jsx("pre",{children:JSON.stringify(p,null,2)})]})]})};export{S as OpsPanel};
